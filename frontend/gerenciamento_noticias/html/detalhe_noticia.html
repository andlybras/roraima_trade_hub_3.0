{% extends 'base.html' %}
{% load static %}
{% block titulo %}{{ noticia.titulo }} | Roraima Trade Hub{% endblock %}
{% block meta_tags %}
    {% if noticia.meta_descricao %}
    <meta name="description" content="{{ noticia.meta_descricao }}">
    {% endif %}
    {% if noticia.palavras_chave %}
    <meta name="keywords" content="{{ noticia.palavras_chave }}">
    {% endif %}
{% endblock meta_tags %}
{% block css_pagina %}
<link rel="stylesheet" href="{% static 'gerenciamento_noticias/css/noticias.css' %}">
{% endblock %}
{% block conteudo %}
<div class="container-conteudo container-noticia-detalhe">
    <nav class="breadcrumb-container" aria-label="breadcrumb">
        <ol class="breadcrumb-list">
            <li class="breadcrumb-item"><a href="{% url 'gerenciamento_home:home' %}" class="breadcrumb-link">Início</a></li>
            <li class="breadcrumb-item"><a href="{% url 'noticias:lista_noticias' %}" class="breadcrumb-link">Notícias</a></li>
            {% if noticia.categorias.first %}
                <li class="breadcrumb-item"><a href="{% url 'noticias:noticias_por_categoria' noticia.categorias.first.slug %}" class="breadcrumb-link">{{ noticia.categorias.first.name }}</a></li>
            {% endif %}
            <li class="breadcrumb-item active" aria-current="page">{{ noticia.titulo|truncatechars:30 }}</li>
        </ol>
    </nav>
    <article class="painel-noticia">
        <div class="noticia-cabecalho">
            <h1 class="noticia-titulo-detalhe">{{ noticia.titulo }}</h1>
            {% if noticia.subtitulo %}
            <h2 class="noticia-subtitulo-detalhe">{{ noticia.subtitulo }}</h2>
            {% endif %}
            <p class="noticia-meta">
                Por 
                <a href="{% url 'noticias:noticias_por_autor' noticia.autor.username %}">
                    <strong>{{ noticia.autor.get_full_name|default:noticia.autor.username }}</strong>
                </a>
                <br>
                Publicado em: {{ noticia.data_publicacao|date:"d \d\e F \d\e Y, H:i" }}
                {% if noticia.data_atualizacao|timesince != noticia.data_criacao|timesince %}
                (Atualizado em: {{ noticia.data_atualizacao|date:"d/m/Y, H:i" }})
                {% endif %}
            </p>
        </div>
        <img class="noticia-imagem-detalhe" src="{{ noticia.imagem_destaque.url }}" alt="Imagem de destaque para a notícia: {{ noticia.titulo }}">
        <div class="noticia-corpo">
            {{ noticia.corpo|safe }}
        </div>
        {% if noticia.tags.all %}
        <div class="noticia-tags">
            <strong>Tags:</strong>
            {% for tag in noticia.tags.all %}
            <a href="{% url 'noticias:noticias_por_tag' tag.slug %}" class="tag-link">{{ tag.name }}</a>
            {% endfor %}
        </div>
        {% endif %}
        <div class="noticia-compartilhamento">
            <h4>Compartilhe esta notícia:</h4>
            <div class="botoes-compartilhamento">
                <a href="https://api.whatsapp.com/send?text={{ noticia.titulo|urlencode }}%20{{ request.build_absolute_uri|urlencode }}" target="_blank" class="share-button whatsapp" aria-label="Compartilhar no WhatsApp">WhatsApp</a>
                <a href="https://www.facebook.com/sharer/sharer.php?u={{ request.build_absolute_uri }}" target="_blank" class="share-button facebook" aria-label="Compartilhar no Facebook">Facebook</a>
                <a href="https://twitter.com/intent/tweet?url={{ request.build_absolute_uri }}&text={{ noticia.titulo|urlencode }}" target="_blank" class="share-button twitter" aria-label="Compartilhar no Twitter/X">Twitter/X</a>
                <a href="https://www.linkedin.com/shareArticle?mini=true&url={{ request.build_absolute_uri }}&title={{ noticia.titulo|urlencode }}" target="_blank" class="share-button linkedin" aria-label="Compartilhar no LinkedIn">LinkedIn</a>
            </div>
        </div>
        {% if materias_relacionadas %}
        <section class="relacionadas-container">
            <h2>Leia Também</h2>
            <div class="relacionadas-grid">
                {% for relacionada in materias_relacionadas %}
                <a href="{{ relacionada.get_absolute_url }}" class="relacionada-card">
                    <div class="relacionada-imagem">
                        <img src="{{ relacionada.imagem_card.url }}" alt="{{ relacionada.titulo }}">
                    </div>
                    <div class="relacionada-conteudo">
                        {% if relacionada.categorias.first %}
                            <span class="relacionada-categoria">{{ relacionada.categorias.first.name }}</span>
                        {% endif %}
                        <h3 class="relacionada-titulo">{{ relacionada.titulo }}</h3>
                    </div>
                </a>
                {% endfor %}
            </div>
        </section>
        {% endif %}
        {# ================================================================================= #}
        {# ==                LEMBRETE CRÍTICO DE PRÉ-LANÇAMENTO (Facebook Comments)       == #}
        {# ================================================================================= #}
        {#                                                                                   #}
        {# ATENÇÃO: A seção de comentários do Facebook abaixo está ATIVA SEM MODERAÇÃO.      #}
        {#                                                                                   #}
        {# ISSO É UM RISCO DE SEGURANÇA E CREDIBILIDADE para o portal. Sem moderação,        #}
        {# qualquer pessoa pode postar spam, conteúdo ofensivo ou desinformação.             #}
        {#                                                                                   #}
        {# AÇÃO NECESSÁRIA ANTES DE LANÇAR O SITE AO PÚBLICO:                                #}
        {#                                                                                   #}
        {# 1. Criar um App no Facebook Developers associado a uma conta institucional do     #}
        {#    Governo (via Meta Business Suite), conforme discutido.                         #}
        {#                                                                                   #}
        {# 2. Obter o "ID do Aplicativo" (App ID) gerado por este processo.                  #}
        {#                                                                                   #}
        {# 3. Adicionar a seguinte meta tag ao arquivo `frontend/base.html` dentro da        #}
        {#    tag <head>:                                                                    #}
        {#                                                                                   #}
        {#    <meta property="fb:app_id" content="COLE_O_ID_AQUI" />                         #}
        {#                                                                                   #}
        {# ================================================================================= #}
        <div class="noticia-comentarios">
            <div class="fb-comments" 
                 data-href="{{ request.build_absolute_uri }}"
                 data-width="100%" 
                 data-numposts="5">
            </div>
        </div>
    </article>
</div>
{% endblock %}